---
title: Bitcoin Fee Estimation
layout: default
navactive: Home
---
<!-- <div id="graph" class="embed-responsive embed-responsive-4by3"></div> -->
<div id="graph"
     style="width:80vw;height:60vw;min-width:640px;min-height:480px;max-width:1080px;max-height:810px;">
</div>
<nav>
  <ul id="res-select" class="pagination">
    <li id="1m"><a href="/#1m">1m</a></li>
    <li id="30m"><a href="/#30m">30m</a></li>
    <li id="3h"><a href="/#3h">3h</a></li>
    <li id="1d"><a href="/#1d">1d</a></li>
  </ul>
</nav>

<script type="text/javascript">
  var targetspin = document.getElementById("graph")
  var RESMAP = {
    "#1m": 1,
    "#30m": 2,
    "#3h": 3,
    "#1d": 4
  };

  function clearResButtons() {
    for (res in RESMAP)
      $(res).removeAttr("class")
  }

  function plotRRD(res) {
    // start the loading spin
    $("#graph").html("")
    var spinner = new Spinner().spin(targetspin)
    if (!(res in RESMAP))
      res = "#1m";
    clearResButtons();
    $(res).attr("class", "active");
    var resnumber = RESMAP[res]
    var url = worksheetURL(resnumber)
    $.getJSON(url, function(data) {
      spinner.stop()
      t = getCol(data, "time").map(function(el) {return el*1000;});
      m12 = getCol(data, "m12");
      m20 = getCol(data, "m20");
      m30 = getCol(data, "m30");
      m60 = getCol(data, "m60");
      mempoolsize = getCol(data, "mempoolsize");
      txbyterate = getCol(data, "txbyterate");
      capbyterate = getCol(data, "capbyterate");
      var data = [
        {
          name: "12 min",
          x: t,
          y: m12,
          type: "scatter"
        },
        {
          name: "20 min",
          x: t,
          y: m20,
          type: "scatter"
        },
        {
          name: "30 min",
          x: t,
          y: m30,
          type: "scatter"
        },
        {
          name: "60 min",
          x: t,
          y: m60,
          type: "scatter"
        },
        {
          name: "Mempool size",
          yaxis: "y2",
          x: t,
          y: mempoolsize,
          xaxis: "x2",
          line: {
            color: "black"
          },
          type: "scatter"
        },
        {
          name: "Tx byterate",
          yaxis: "y2",
          x: t,
          y: txbyterate,
          xaxis: "x2",
          line: {
            color: "black",
            dash: "dot"
          },
          type: "scatter"
        },
        {
          name: "Capacity byterate",
          yaxis: "y2",
          x: t,
          y: capbyterate,
          xaxis: "x2",
          line: {
            color: "black",
            dash: "dash"
          },
          type: "scatter"
        }
      ];
      var layout = {
        title: "Required fee rate for given expected wait time",
        yaxis2: {
          domain: [0, 0.45],
          rangemode: "tozero",
          title: "Bytes or<br>Bytes per decaminute",
          type: "linear",
          autorange: true
        },
        yaxis: {
          domain: [0.55, 1],
          rangemode: "tozero",
          title: "Fee rate<br>(satoshis per kB)",
          type: "linear",
          autorange: true
        },
        xaxis2: {
          anchor: "y2",
          title: "Time (local)",
          type: "date",
          autorange: true
        },
        xaxis: {
          type: "date",
          autorange: true
        },
      };
      putGraph(data, layout, "graph")
      //Plotly.Plots.resize(document.getElementById("graph") )

    });
  }

  $(document).ready(function() {
    plotRRD(window.location.hash);
  })

  $(window).on('hashchange', function() {
    plotRRD(window.location.hash);
  });

  $(window).on('resize', function() {
    Plotly.Plots.resize(document.getElementById("graph"));
  });
</script>
